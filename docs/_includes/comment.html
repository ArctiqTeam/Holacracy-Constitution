<div class="comment {% unless include.replying_to == 0 %}child{% endunless %}" id="comment{% unless include.r %}{{ index | prepend: '-' }}{% else %}{{ include.index | prepend: '-' }}{% endunless %}">
  <div class="w3-row-padding w3-padding-large">
    <div class="w3-right w3-mobile">
      <span>{{ include.date | date: "%B %d, %Y" }}</span>
    </div>
    <div class="w3-twothirds w3-mobile">
      <img class="comment_avatar" src="https://www.gravatar.com/avatar/{{ include.email }}?d=mm&s=50" srcset="https://www.gravatar.com/avatar/{{ include.email }}?d=mm&s=100 2x" alt="{{ include.name }}" height="50" width="50">
      <h3>{{ include.name }}</h3>
    </div>
    <div class="w3-mobile">
      {{ include.message | markdownify }}
    </div>
    {% unless include.replying_to != 0 or page.comments_locked == true %}
    <div class="w3-right w3-mobile">
      <a rel="nofollow" href="#" onclick="return formReply('comment-replying-to', '{{ include.index }}')">
        <i class="fa fa-reply" aria-hidden="true"></i><span> - Reply to {{ include.name }}</span></a>
    </div>
    <p id="test"></p>
    {% endunless %}
  </div>
</div>

<!-- <a href='javascript:;' onclick='show_more_menu();'>More ></a> -->

{% capture i %}{{ include.index }}{% endcapture %}
{% assign replies = site.data.comments[post_slug] %}
{% for reply in replies | sort: 'date' %}
{% if reply[1].replying_to == i %}
  {% assign index       = forloop.index | prepend: '-' | prepend: include.index %}
  {% assign r           = reply[1].replying_to %}
  {% assign replying_to = r | to_integer %}
  {% assign email       = reply[1].email %}
  {% assign name        = reply[1].name %}
  {% assign date        = reply[1].date %}
  {% assign message     = reply[1].message %}
  {% include comment.html index=index replying_to=replying_to email=email name=name date=date message=message %}
{% endif %}
{% endfor %}
